<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Amber ‚Äì Results</title>
  <style>
:root{
  --bg:#eaf4ff;
  --card:#ffffff;
  --ink:#0f172a;
  --muted:#5b6478;
  --accent:#2563eb;
  --accent-weak:#dbeafe;
  --ring:rgba(37,99,235,.25);
  --shadow:0 10px 25px rgba(2,6,23,.06);
  --radius:16px;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0}
body{
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji';
  color:var(--ink);
  background:linear-gradient(180deg,var(--bg),#f7fbff 60%);
}
.container{max-width:1100px;margin:32px auto;padding:0 20px}
.header{
  display:flex;align-items:center;justify-content:space-between;margin-bottom:24px;
}
.brand{display:flex;align-items:center;gap:12px;font-weight:800;font-size:20px}
.brand .logo{
  width:36px;height:36px;border-radius:10px;background:var(--accent);
  box-shadow:inset 0 -10px 20px rgba(255,255,255,.25);
  display:grid;place-items:center;color:white;font-weight:900;
}
.subtle{color:var(--muted)}
.grid{
  display:grid;gap:16px;
  grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
}
.card{
  background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;border:1px solid #eef2ff;
}
.card h3{margin:4px 0 4px;font-size:18px}
.card p{margin:0;color:var(--muted);font-size:14px}
.btn{
  display:inline-flex;align-items:center;gap:8px;
  background:var(--accent);color:#fff;border:none;border-radius:10px;
  padding:10px 14px;font-weight:700;cursor:pointer;box-shadow:var(--shadow);
}
.btn.secondary{background:var(--accent-weak);color:var(--accent);}
.section{margin-top:24px}
.table{width:100%;border-collapse:separate;border-spacing:0 8px;margin-top:10px}
.table th,.table td{padding:10px 12px;background:#f8faff}
.table th{color:#334155;font-size:12px;letter-spacing:.02em;text-transform:uppercase;background:#eef2ff}
.table tr{box-shadow:var(--shadow)}
.kicker{font-weight:800;letter-spacing:.02em;text-transform:uppercase;color:#334155;margin:6px 0 10px;font-size:14px}
.charts{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));}
canvas{width:100%;height:240px}
.backlink{display:inline-flex;align-items:center;gap:8px;color:var(--accent);text-decoration:none;font-weight:700}
</style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <a href="index.html" class="backlink">‚Üê Back to class</a>
      <div class="brand"><div class="logo">üìà</div>Amber's Progress</div>
    </div>

    <div class="card">
      <h2 style="margin:0;">Overview</h2>
      <p class="subtle" style="margin-top:6px;">Live from Google Sheets tab: <strong>Amber</strong></p>
    </div>

    <div class="section">
      <div class="kicker">All Results (table)</div>
      <div class="card">
        <table class="table">
          <thead><tr id="headers"></tr></thead>
          <tbody id="rows"></tbody>
        </table>
      </div>
    </div>

    <div class="section">
      <div class="kicker">Progress Charts</div>
      <div id="charts" class="charts"></div>
    </div>
  </div>

<script>
  const SHEET_ID = "1dQ6IBSgu54prrWeXDYqsH382GIZ-MwHkq8DRi1zXGeQ";
  const TAB = "Amber";
  const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(TAB)}`;

  function parseCSV(text){
    return text.trim().split(/\r?\n/).map(r => r.split(","));
  }
  const stripQ = s => (s||"").replace(/^"|"$/g,"").trim();

  async function loadData(){
    const url = SHEET_URL + "&t=" + Date.now(); // cache-bust
    const res = await fetch(url);
    const text = await res.text();
    const rows = parseCSV(text);
    if(!rows.length) return;

    const headers = rows[0].map(stripQ);
    const headerRow = document.getElementById("headers");
    headers.forEach(h=>{
      const th = document.createElement("th"); th.textContent = h || "Metric / Date"; headerRow.appendChild(th);
    });

    const tbody = document.getElementById("rows");
    rows.slice(1).forEach(row=>{
      if(row.every(c => stripQ(c)==="")) return;
      const tr = document.createElement("tr");
      row.forEach(cell=>{ const td = document.createElement("td"); td.textContent = stripQ(cell); tr.appendChild(td); });
      tbody.appendChild(tr);
    });

    const dates = headers.slice(1);
    const chartsDiv = document.getElementById("charts");

    const preferredMax = (metric)=>{
      const m = metric.toLowerCase();
      if(m.includes("orf")) return 200;
      if(m.includes("maze")) return 40;
      if(m.includes("spelling")) return 20;
      if(m.includes("handwriting")) return 60;
      return undefined; // auto
    };

    rows.slice(1).forEach(row=>{
      const metric = stripQ(row[0]); if(!metric) return;
      const values = row.slice(1).map(v=>{ const n = parseFloat(stripQ(v)); return isNaN(n)? null : n; });

      const card = document.createElement("div"); card.className="card";
      const h = document.createElement("h3"); h.textContent = metric; card.appendChild(h);
      const canvas = document.createElement("canvas"); card.appendChild(canvas);
      chartsDiv.appendChild(card);

      new Chart(canvas.getContext("2d"), {
        type:"line",
        data:{ labels: dates, datasets:[{ label: metric, data: values, fill:true, tension:.35 }] },
        options:{
          responsive:true,
          plugins:{ legend:{ display:false } },
          scales:{ y:{ beginAtZero:true, suggestedMax: preferredMax(metric) } }
        }
      });
    });
  }
  loadData();
</script>
</body>
</html>
